<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAPER | CANONIC</title>
    <link rel="stylesheet" href="https://canonic-foundation.github.io/assets/style.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <nav class="topnav">
        <a href="https://canonic-apps.github.io" class="topnav-brand">∩</a>
        <div class="topnav-links">
            <a href="https://canonic-foundation.github.io">Foundation</a>
            <a href="https://canonic-apps.github.io">Apps</a>
            <a href="./" class="active">Paper</a>
        </div>
    </nav>

    <section class="hero">
        <div class="symbol">∩</div>
        <h1>CANONIC</h1>
        <p class="tagline">Constitutional AI Governance</p>
        <div class="flow" id="version-nav">
            <span class="flow-item active" data-version="V0">V0 MACHINE</span>
            <span class="flow-arrow">→</span>
            <span class="flow-item dim" data-version="V1">V1 FOUNDATION</span>
            <span class="flow-arrow">→</span>
            <span class="flow-item dim" data-version="V2">V2 APPS</span>
            <span class="flow-arrow">→</span>
            <span class="flow-item dim" data-version="V3">V3 DISTRIBUTED</span>
        </div>
    </section>

    <article id="paper-content">
        <p style="text-align: center; color: var(--dim);">Loading manuscript...</p>
    </article>

    <footer>
        <p><a href="https://canonic-foundation.github.io">Foundation</a> | <a href="https://github.com/canonic-apps/PAPER">GitHub</a></p>
        <p>The paper proves itself by running.</p>
    </footer>

    <script src="https://canonic-foundation.github.io/assets/nav.js"></script>
    <script>
        const versions = {
            V0: { era: 'MACHINE', status: 'closed', date: '2026-01-23' },
            V1: { era: 'FOUNDATION', status: 'in-progress', date: '2026' },
            V2: { era: 'APPS', status: 'planned', date: 'TBD' },
            V3: { era: 'DISTRIBUTED', status: 'planned', date: 'TBD' }
        };

        let currentVersion = 'V0';

        async function loadPaper(version) {
            const content = document.getElementById('paper-content');
            const info = versions[version];

            if (info.status === 'planned') {
                content.innerHTML = '<div class="meta">' + version + ' | ' + info.era + ' Era | Planned</div><h2>Coming Soon</h2><p>This version is planned for future development.</p>';
                return;
            }

            content.innerHTML = '<p style="text-align: center; color: var(--dim);">Loading manuscript...</p>';

            try {
                const response = await fetch('https://raw.githubusercontent.com/canonic-apps/PAPER/main/' + version + '/manuscript.md');
                if (!response.ok) throw new Error('Not found');
                const markdown = await response.text();
                marked.setOptions({ breaks: true, gfm: true });
                content.innerHTML = '<div class="meta">' + version + ' | ' + info.era + ' Era | ' + info.date + '</div>' + marked.parse(markdown);
            } catch (e) {
                content.innerHTML = '<div class="meta">' + version + ' | ' + info.era + ' Era</div><h2>Manuscript</h2><p>Loading from repository...</p>';
            }
        }

        document.querySelectorAll('#version-nav .flow-item').forEach(item => {
            item.style.cursor = 'pointer';
            item.addEventListener('click', () => {
                document.querySelectorAll('#version-nav .flow-item').forEach(i => {
                    i.classList.remove('active');
                    i.classList.add('dim');
                });
                item.classList.add('active');
                item.classList.remove('dim');
                loadPaper(item.dataset.version);
            });
        });

        loadPaper('V0');
    </script>
</body>
</html>
